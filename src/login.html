<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>登录</title>
    <script src="./js/libs/jquery.js"></script>
    <script src="./js/layer-v3.5.1/layer/layer.js"></script>
    <link rel="stylesheet" href="./css/reset.css">
    <link rel="stylesheet" href="./css/login.css">
</head>
<body class="w990">
    <!-- head start -->
    <div id="gome-head" class="wbox">
        <div id="logo">
            <a href=""></a>
        </div>
    </div>
    <!-- head end -->
    <!-- tips start -->
    <div class="safeTipDiv">
        <p class="safeTip">
            <em></em>
            依据《网络安全法》，为保障您的账户安全和正常使用，请尽快完成手机号验证！新版
            <a href="">《真快乐平台隐私政策》</a>
            已上线，将更有利于保护您的个人隐私。
        </p>
    </div>
    <!-- tips end -->

    <!-- main start -->
    <div class="content-bg">
        <div class="main clearfix">
            <div class="login-box-wrap">
                <div class="loginHead clearfix">
                    <div class="loginTab tabLeft" id="tabLeft">
                        <a href="javascript:void(0)">扫码登录</a>
                    </div>
                    <div class="loginTab tabRight" id="tabRight">
                        <a href="javascript:void(0)">账户登录</a>
                    </div>
                </div>
                <div class="loginBox">
                    <!-- 扫码登录区域 -->
                    <div class="sm-login-box login-wrap" id="sm-login">
                        <div class="default-state">
                            <div class="qrcode-main clearfix" id="barcodeId">
                                <div class="qrcode-Image">
                                    <img src="./images/index/reg.png" alt="" id="kaptchaImage22">
                                </div>
                                <div class="qrcode-help"></div>
                            </div>
                        </div>
                        <p class="qrcode-desc">
                            打开手机
						<a href="" class="blink">真快乐</a>

                        </p>
                        <p class="smCode">扫一扫登录</p>
                        <a href="javascript:void(0)" class="fontBlink fr registerBtn">免费注册</a>
                    </div>
                    <!-- 账号登陆区域 start -->
                    <div class="login-wrap" id="accountlogin">
                        <form action="" id="frm">
                            <div class="normalLogin">
                                <!-- 请输入你的密码 -->
                                <div id="err-tip">
                                    <span class="icon"></span>
                                    <div>
                                        <p>
                                            <b class="errMsg" style="font-weight: normal;"></b>
                                        </p>
                                    </div>
                                </div>
                                <!-- 勾选自动登录提示 -->
                                <p class="tips warningTip">
                                    <em></em>
                                    公共场所不建议自动登录，以防账号丢失
                                </p>
                                <!-- 登录账号区域 start -->
                                <div class="login-item login-item-name" id="loginNameDiv">
                                    <!--a 清空  -->
                                    <a href="javascript:void(0)" class="clear-btn"></a>
                                    <!-- 账号站位提示 -->
                                    <span class="default" id="loginNameDefault">目前只支持手机号码登录!</span>
                                        <!-- 输入框 -->
                                    <input name="loginName" id="loginName" tabindex="1" type="text" class="txt txt-focus">
                                </div>
                                <!-- 登录账号区域结束 -->
                                <!-- 登录密码区域 start -->
                                <div class="login-item login-item-pwd" id="loginPasswordDiv">
                                    <a href="javascript:;" class="clear-btn"></a>
                                    <span class="default" id="loginPasswordDefault">密码</span>
                                    <input type="password" class="txt txt-focus"  id="loginPassword" autocomplete="off" onkeypress ="testCapsLock(event)" >
                                    <!-- 密码输入提示大写,默认隐藏 -->
                                    <span id="capital_tip" class="capital-tip">大写锁定已打开</span>  
                                </div>
                                <!-- 登录密码区域 end -->
                                 <!-- 验证码部分 滑动验证 以后找插件写吧 start-->  
                                 <!-- 验证码部分 滑动验证 以后找插件写吧 end-->  

                                 <!-- 自动登录 start -->
                                 <div class="remember overflowhide clearfix">
                                     <div class="fl">
                                        <input type="checkbox" id="autoLoginFlag" name="autoLoginFlag" class="ckbx autoLoginFlag" value="radiobutton">
                                        <label for="autoLoginFlag">自动登录</label>
                                     </div>
                                     <div class="fr" style="width: 120px;">
                                         <a href="" class="forgetpwdmsg fl" title="忘记密码">忘记密码</a>
                                         <span class="fl paddrl10 displayb colorccc">|</span>
                                         <a href="" class="fontBlink fr" title="免费注册">免费注册</a>
                                     </div>
                                 </div>
                                 <!-- 自动登录 end -->
                                 <!-- 登录按钮 start -->
                                 <div class="actions">
                                    <input type="submit" value="登 录" class="btnnuw">
                                 </div>
                                 <!-- 登录按钮 end -->
                                 <!-- 手机号快速登录  start-->
                                 <p style="padding: 30px 0 15px;">
                                    <a href="javascript:;" class="fontBlink phoneLoginBtn">手机号快速登录(支持门店预留手机)</a>
                                </p>

                                  <!-- 手机号快速登录  end-->
                            </div>
                        </form>
                    </div>
                    <!-- 账号登录 end -->
                </div>

                <!-- 第三方登录区域 start -->
                <dl class="corp-login" id="corp-login">
                    <dd class="play_icon clearfix">
                        <a href="" class="borderLine">门店会员卡登录</a>
                        <a href="" class="borderLine">QQ</a>
                        <a href="" class="borderLine">微信</a>
                        <a href="" class="borderLine">微博</a>
                        <a href="" class="borderLine">美付宝</a>
                        <a href="" class="borderLine loginhide">极信通</a>
                        <a href="" class="borderLine loginhide">支付宝</a>
                    </dd>
                    <dd>
                        <a class="more" id="arrowbtn"></a>
                    </dd>
                </dl>
                <!-- 第三方登录区域 end -->
            </div>

            <a href="" class="survey">
                <i class="icon"></i>
                我想对“登录”提意见
            </a>
        </div>
    </div>
    <!-- main end -->


    <!-- footer start -->
    <div id="gome-foot">
        <div id="gome-foot-box" style="width: 990px;margin: 0 auto;">
            <ul style="height: 22px;">
                <li>
                    <a href="">国美控股集团</a>
                </li>
                <li>
                    <a href="">国美控股集团</a>
                </li>
                <li>
                    <a href="">国美控股集团</a>
                </li>
                <li>
                    <a href="">国美控股集团</a>
                </li>
                <li>
                    <a href="">国美控股集团</a>
                </li>
                <li>|</li>
                <li>
                    <a href="">品牌大全</a>
                </li>
                <li>
                    <a href="">品牌大全</a>
                </li>
                <li>
                    <a href="">品牌大全</a>
                </li>
                <li>
                    <a href="">品牌大全</a>
                </li>
                <li>
                    <a href="">品牌大全</a>
                </li>
                <li>
                    <a href="">品牌大全</a>
                </li>
                <li>|</li>
                <li>
                    <a href="">商家入住</a>
                </li>
                <li>
                    <a href="">国美分销</a>
                </li>
            </ul>
            <p>
                本公司游戏产品适合18岁以上成年人使用  违法和不良信息举报电话：021-39900132  
                <a href="" class="interDrug">互联网药品信息服务资格证编号（沪）-经营性-2019-0006</a>
            </p>
            <p>
                网络食品销售第三方平台提供者备案：沪网食备A0015号  
                <a href="" class="interDrug">
                    网络文化经营许可证沪网文[2021] 0385-031 号
                </a>
                &nbsp;&nbsp;
                <a href="" class="interDrug">
                    增值电信业务经营许可证
                </a>
            </p>
            <p>
                客服电话:4008113333  
                <a href="" class="interDrug">
                    沪ICP备11009419号/京ICP备 19011786号
                </a>
                <a href="" class="interDrug">
                    京B2-20191290
                </a>
                <a href="" class="interDrug">
                    经营执照
                </a>
                <a href="" class="interDrug">
                    营业执照
                </a>
                <a href="" class="interDrug">
                    出版物经营许可证
                </a>
            </p>
            <p>
                ©2000-2021  国美在线电子商务有限公司版权所有  
                <a href="" class="interDrug tw-w-ico-wrap">
                    <i class="tw-w-mark-icon"></i>
                    京公网安备 11010502038379号
                </a>
            </p>
            <div class="gome-foot-credit">
                <a href="" class="credit-baxx">
                    <i></i>
                    <b>经营性网站备案信息</b>
                </a>
                <a href="" class="credit-cxwz">
                    <i></i>
                    <b>诚信网站</b>
                </a>
                <a href="" class="credit-hdjc">
                    <i></i>
                    <b>朝阳网络警察</b>
                </a>
                <a href="" class="credit-wgdj">
                    <i></i>
                    <b>网购大家评</b>
                </a>
                <a href="" class="credit-report">
                    <i></i>
                    <b>上海市互联网违法和不良信息举报中心</b>
                </a>
                <a href="" class="credit-hazar">
                    <i></i>
                    <b>网上有害信息举报专区</b>
                </a>
            </div>
        </div>
    </div>
    <!-- footer end -->
</body>
</html>
<script>

    // 建议显示记住密码建议显示
    // 建议显示默认为关
    // 账号登陆默认隐藏
    $(function(){
        // 表单动态属性,用prop()方法去获取
        $("#autoLoginFlag").on("click",function(){
           if($("#autoLoginFlag").prop("checked")){
               $(".warningTip").css("display","block")
           }
           if(!$("#autoLoginFlag").prop("checked")){
               $(".warningTip").css("display","none")
           }
        })
    })

    // 简单判断判断大小写函数
    function  testCapsLock(event){  
    var valueCapsLock = event.keyCode ? event.keyCode:event.which; // 按键   
    var valueShift = event.shiftKey ? event.shiftKey:((valueCapsLock == 16 ) ? true : false ); // shift键是否按住  
    if (((valueCapsLock >= 65 && valueCapsLock <= 90 ) && !valueShift) // 输入了大写字母，并且shift键没有按住，说明Caps Lock打开
        || ((valueCapsLock >= 97 && valueCapsLock <= 122 ) && valueShift)){// 输入了小写字母，并且按住 shift键，说明Caps Lock打开
            $("#capital_tip").css("display","block");
            return true;
        } else {
            $("#capital_tip").css("display","none")
            return false;
        } 
    }   
    // 调研部分,移入移出事件
    $(".survey").hover(function(){
        $(this).addClass("surveyhover")
    },function(){
        $(this).removeClass("surveyhover")
    })
    // 默认扫码登录为红色
    $("#tabLeft").children("a").addClass("cur")
    // 登录界面点击事件
    $(".loginHead").on("click",".loginTab",function(evt){
        //事件委托
        let e=evt.window||evt.srcElement;
        $(this).children("a").addClass("cur")
        .parent().siblings().children("a").removeClass("cur");
        // 获取点击登录事件的下标
        let $index=$(this).index();
        console.log($index);
        if($index==0){
            $("#sm-login").css("display","block"),
            $("#accountlogin").css("display","none")
        }
        if($index==1){
            $("#sm-login").css("display","none"),
            $("#accountlogin").css("display","block")
        }

    })
    // 点击账号登陆跳转到Z行号登录,扫码登录消失

    $(".qrcode-Image").css({"left":75})
    // 移入二维码时的动画效果
   $(".qrcode-Image").hover(function(){
    $(".qrcode-Image").stop().animate({"left":"0px"},500,function(){
        $(".qrcode-help").css("display","block")
    })
   },function(){
    $(".qrcode-Image").css({"left":75})
    $(".qrcode-help").css({display:"none"})
   })

        // 登录方式选择时默认隐藏 极信通和支付宝,点击按钮时显示
        $(".loginhide").hide();
        // 点击按钮时,按钮里面图片位置改变
        $("#arrowbtn").click(function(){
            if($(this).hasClass("uparrowbtn")){
                $(this).removeClass("uparrowbtn");
                $(".loginhide").hide();
            }
            else{
                $(this).addClass("uparrowbtn");
                $(".loginhide").show();
            }
        })
    // 点击跳转跳转到登录页面
    $(".registerBtn").on("click",function(){
        layer.msg("即将跳转,请稍候!")
        setTimeout(function(){
            location.assign("./reg.html");
        },1500)

    })
    // 清空点击事件
    // 默认隐藏
    $(".clear-btn").css("display","none")
    class Input{
        constructor({el}){
            this.$el=$(el);
            this.$clearBtn=this.$el.parent().children(".clear-btn");
            this.$default=this.$el.parent().children(".default");
            this.inputHandler();
            this.clickBtnHandler();
        }
        // 1.点击清空输入框事件
        inputHandler(){
            this.$el.on("input",()=>{
                if(this.$el.val().trim().length>=1){
                    this.$clearBtn.css("display","block");
                    this.$default.css("display","none");
                }else{
                    this.$clearBtn.css("display","none");
                    this.$default.css("display","block");
                }
            })
        }
        // 2.点击清空事件
        clickBtnHandler(){
            this.$clearBtn.on("click",()=>{
                this.$el.val("");
                this.$clearBtn.css("display","none");
                this.$default.css("display","block");
            })
        }
    }
    new Input({
        el:"#loginName"
    })
    new Input({
        el:"#loginPassword"
    })

    // 登录事件判断
    let nameLength=$("#loginName").val().trim().length;
    let passwordLength=$("#loginPassword").val().trim().length;
    $("form").eq(0).on("submit",function(){
        if(!(nameLength>0)){
            $("#err-tip").css("display","block")
            .children(".errMsg").text("请输入用户名");
        }
        if(!(passwordLength>0)){
            $("#err-tip").css("display","block")
            .children(".errMsg").text("请输入密码");
        }
        var oUser={
            user:$("#loginName").val().trim(),
            pwd:$("#loginPassword").val().trim()
        }
        $.ajax({
            url:"/accout/login",
            type:"post",
            data:oUser
        }).then(function(res){
            console.log(res);
            if(res.msg=="登录失败"){
                $("#err-tip").css("display","block")
                .children(".errMsg").text("账号或者密码错误,请重新输入");
            }
            layer.msg(res.msg);
            if(res.data&&res.code==200){
                // 把当前登录人的信息保存到 localStorage
                // 关闭浏览器也会保存
                localStorage.setItem("userinfo",JSON.stringify(res.data));
                setTimeout(function(){
                    layer.msg("登录成功,将自动跳转到首页!");
                    location.assign("./index.html");
                },2000)
            }
        })
        // 取消默认行为
        return false
    })

</script>